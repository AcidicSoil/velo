---
project: velo
version: 1.0
purpose: >
  Velo is a privacy-first, cross-platform CLI assistant designed to automate, analyze, and accelerate development workflows. It leverages local AI models and extensible agentic plugins to support code intelligence, project bootstrapping, and workflow automation directly within the developer’s terminal.

target_users:
  - Software developers (beginner to advanced)
  - Site Reliability Engineers (SREs)
  - DevOps and automation engineers
  - Technical writers and code reviewers

platforms:
  - CLI (macOS, Linux, Windows; Go binary)
  - Python for plugin/extension system (via embedded Python or process bridge)
  - Local AI inference with optional cloud LLMs (future roadmap)

status: In Development

unique_value:
  - Works offline with local LLMs (llama.cpp)
  - Extensible with Python agent plugins using agentic patterns (DSPy)
  - Strong focus on privacy, transparency, and auditability
  - Autogenerated CLI documentation
  - Fast, portable, and cross-compiled binaries

---

## Objectives

- Deliver context-aware code analysis, generation, and refactoring from the CLI
- Automate repetitive or complex tasks via natural language and plugin workflows
- Enable private, local-first AI assistant capabilities with no forced cloud dependency
- Provide an open plugin/extension system leveraging Python’s AI ecosystem
- Support advanced automation via agentic (multi-step, tool-using) patterns

---

## Core Features

- **Conversational CLI interaction:** Natural language commands (“Summarize this file”, “Fix lint errors”, “Scaffold a config”)
- **Code summarization and review:** Summarize code, suggest improvements, identify anti-patterns
- **Project bootstrapping:** Scaffold new projects, generate boilerplate, create configs (via `velo init`, etc.)
- **Integrated version control workflows:** Enhanced git status, diffs, commit suggestions
- **Third-party tool integration:** Interact with Docker, CI/CD, other CLI tools
- **Plugin/extension system:** Python plugins (loaded dynamically), supporting DSPy for agentic orchestration
- **LLM model management:** Download, configure, and use local LLMs (llama.cpp family); optional remote models (future)
- **Interactive troubleshooting:** Analyze errors and recommend fixes (“Why did my build fail?”)
- **Autogenerated help/docs:** CLI help generated from command definitions and plugin docstrings

---

## Non-Goals

- Not a full IDE replacement
- Not a background daemon or shell replacement
- No persistent code/data uploads or telemetry by default
- Not a continuous integration system (though can automate CI/CD config/tasks)

---

## Command & Feature Examples

| Command                  | Description                                      | Example Usage                                 |
|--------------------------|--------------------------------------------------|-----------------------------------------------|
| velo help                | List available commands and plugins              | `velo help`                                   |
| velo analyze <file>      | Summarize, review, and suggest code changes      | `velo analyze main.go`                        |
| velo init                | Bootstrap a new project or config                | `velo init`                                   |
| velo git status          | Enhanced git status with suggestions             | `velo git status`                             |
| velo models list         | List available local models                      | `velo models list`                            |
| velo plugin install <url>| Install a Python plugin/extension                | `velo plugin install <repo_url>`              |
| velo agent run <task>    | Execute a multi-step agentic workflow            | `velo agent run "fix all TODOs"`              |
| velo config set <key>    | Set or update YAML config values                 | `velo config set models.default llama-2-7b`   |

---

## Example User Flows

**Summarizing a file**
- User: `velo analyze src/util.py`
- Assistant: Returns summary, highlights issues, suggests improvements

**Bootstrapping a project**
- User: `velo init`
- Assistant: Detects language, prompts for project type, scaffolds config, and prints next steps

**Agentic refactor**
- User: `velo agent run "remove all deprecated APIs"`
- Assistant: Runs DSPy-powered Python agent, analyzes codebase, applies safe refactors, summarizes actions taken

**Installing a plugin**
- User: `velo plugin install https://github.com/example/veloplugin`
- Assistant: Downloads, validates, installs, and loads plugin, exposing new commands

---

## Technical Stack

- **Core CLI:** Go (compiled, cross-platform)
- **LLM Integration:** llama.cpp (via Go bindings or CLI shell), optional: llama-cpp-python bridge for advanced plugins
- **Plugin System:** Python 3.x plugins, loaded via subprocess, embedded interpreter, or FFI
- **Agentic Orchestration:** DSPy (Declarative Self-improving Python) for agentic plugin logic (tool use, chaining, self-improving routines)
- **Configuration:** YAML files (for project, plugins, user/global config)
- **Testing:** LLM/agent behavior tested via deterministic test harnesses (mock responses, workflow assertions)
- **Documentation:** CLI and plugin help autogen’d from code comments/docstrings

---

## Data Handling & Privacy

- Default: all code, data, and prompts processed locally
- No code/data leaves device unless user opts-in for remote LLM usage
- All external model use requires explicit API key and user consent
- CLI supports “dry-run” for any action that may change files
- User config and secrets stored encrypted when possible (future: OS keyring integration)

---

## Security Considerations

- Plugins sandboxed (separate processes, minimal privileges)
- All plugin installs require explicit user confirmation and provenance check
- Encrypted config/API key storage (no plaintext secrets)
- No auto-execution of code from plugin or LLM outputs without user review

---

## Plugin/Extension Architecture

- **Plugin format:** Python package with entry point and metadata (YAML or pyproject.toml)
- **Loading:** Go core discovers and loads plugins, exposes core API via bridge (FFI, gRPC, or subprocess/stdio)
- **Interface:** Plugins declare commands, arguments, expected inputs/outputs in YAML schema
- **Agent plugins:** May use DSPy to orchestrate multi-step or tool-using workflows, with audit trail returned to user
- **Isolation:** Each plugin runs in a sandboxed process/environment (minimize attack surface)

---

## LLM Model Management

- Local models managed via `velo models` CLI (add, list, remove, switch)
- Models must be compatible with llama.cpp or specified Python bindings
- CLI reports current/active model and performance/usage stats
- Optional: cloud model support via API (with explicit user opt-in)

---

## Testing & Automation

- CLI and plugin commands are covered by unit and integration tests
- LLM/agent plugins support deterministic testing via mock responses (YAML testcases)
- Automated validation for plugin manifest/schema

---

## Documentation & Developer Experience

- All CLI commands and plugin commands generate help output from code docstrings/comments
- Usage examples embedded in help output and README
- CLI includes “first-run” onboarding walkthrough for new users

---

## Integration Points

- **Git:** Enhanced git status/diff/commit workflows
- **Docker:** Analyze Dockerfiles, automate builds, scan for issues
- **Python Plugins:** For advanced automation, tool use, agentic workflows (DSPy)
- **Optional (future):** Kubernetes, cloud provider CLIs, cloud LLM APIs

---

## Error Handling & Recovery

- All actions return explicit error/success/failure messages
- Destructive actions default to “dry-run” mode; require confirmation to apply
- Undo/redo available for major workflows (where feasible)
- Detailed error explanations and next steps suggested (when possible)

---

## Security & Privacy Posture

- **Local-first** by default—nothing leaves user’s machine unless clearly opted-in
- No telemetry, analytics, or phone-home by default
- Plugin store/discovery via trusted sources only (user can add custom sources)

---

## Positioning & Comparison

- **Like gemini-cli:** Conversational, context-aware CLI, but offline-first and extensible with Python plugins/agents
- **Like codex/open-code:** AI code generation and review, but focused on CLI workflows and local models
- **Unique to velo:** Strong privacy, open agentic plugin API, Go+Python hybrid, and auditability

---

## Development Phases / Milestones

1. CLI core MVP: Go binary, YAML config, basic LLM integration
2. Plugin/extension system: Python plugin loading, manifest/schema
3. Agentic plugin support: DSPy integration, multi-step workflows
4. Model management CLI: add/list/remove/switch local models
5. Git, Docker, and project analysis integrations
6. Testing framework for CLI/agent/LLM workflows
7. Autogenerated docs and onboarding
8. Optional: cloud LLM API support

---

## Key Challenges & Solutions

| Challenge                                   | Solution                                                      |
|----------------------------------------------|---------------------------------------------------------------|
| Secure plugin execution                     | Sandboxed subprocesses, clear review prompts                  |
| Reliable local LLM inference                | Use llama.cpp, expose clear model management in CLI           |
| Multi-language plugin support                | YAML schema + FFI bridge, focus on Python for v1              |
| Deterministic LLM/agent testing             | Mocking harness for repeatable CLI/plugin tests               |
| User trust & onboarding                     | Privacy-first defaults, explicit help, dry-runs, onboarding   |
| Performance across platforms                | Cross-compile Go binaries, model management docs              |

---

## Ideas for Future Expansion

- GUI/desktop companion app
- Visual workflow/agent builder
- Multi-user collaboration/sharing
- Community plugin registry with trust/rating signals
- Agentic plugin “marketplace” with review/audit tools

---

## Changelog

- v1.0: Initial design, CLI scaffolding, plugin/agentic system planned

---

## Contribution & Contact

- [GitHub: AcidicSoil/velo](https://github.com/AcidicSoil/velo)
- Issues, PRs, and discussions welcome!
- For plugin/API proposals: open an issue or join discussions

---

## Guidance for AI Assistants Consuming this File

- **Prioritize privacy, local model usage, and explicit user intent**
- **Never assume remote/cloud access unless user opts in**
- **Recommend agentic (multi-step, tool-using) workflows for complex automation via plugins**
- **Always return actionable, explainable outputs for each command**
- **Respect plugin boundaries and sandboxing—never execute untrusted code**
- **Use YAML config for all persistent data, plugin manifests, and testcases**
- **Help users by providing examples, dry-run options, and links to autogenerated docs**
- **If unsure, ask user for clarification before taking action**

---

